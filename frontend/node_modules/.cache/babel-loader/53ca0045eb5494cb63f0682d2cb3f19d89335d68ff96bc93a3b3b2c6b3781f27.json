{"ast":null,"code":"import _objectSpread from\"/var/www/test1/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import NewsAPI from'../services/api';import NewsSource from'../components/NewsSource';import LoadingSpinner from'../components/LoadingSpinner';import ErrorMessage from'../components/ErrorMessage';import SkeletonLoader from'../components/SkeletonLoader';import{exportToJSON,exportToCSV}from'../utils/exportUtils';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Dashboard=()=>{const[newsData,setNewsData]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[refreshing,setRefreshing]=useState(false);const[searchTerm,setSearchTerm]=useState('');const[selectedSources,setSelectedSources]=useState([]);const fetchNews=async()=>{try{setError(null);const data=await NewsAPI.getNews();setNewsData(data);}catch(err){setError(err instanceof Error?err.message:'Failed to fetch news');console.error('Failed to fetch news:',err);}finally{setLoading(false);}};const handleRefresh=async()=>{try{setRefreshing(true);setError(null);await NewsAPI.refreshNews();await fetchNews();}catch(err){setError(err instanceof Error?err.message:'Failed to refresh news');console.error('Failed to refresh news:',err);}finally{setRefreshing(false);}};const handleRetry=()=>{setLoading(true);fetchNews();};// Initialize selected sources when news data loads\nuseEffect(()=>{if(newsData&&selectedSources.length===0){setSelectedSources(newsData.sources.map(source=>source.name));}},[newsData]);useEffect(()=>{fetchNews();},[]);// Filter data based on search term and selected sources\nconst filteredData=React.useMemo(()=>{if(!newsData)return null;const filtered=_objectSpread(_objectSpread({},newsData),{},{sources:newsData.sources.filter(source=>selectedSources.includes(source.name)).map(source=>_objectSpread(_objectSpread({},source),{},{headlines:source.headlines.filter(headline=>headline.title.toLowerCase().includes(searchTerm.toLowerCase())||headline.source.toLowerCase().includes(searchTerm.toLowerCase()))})).filter(source=>source.headlines.length>0||searchTerm==='')});return filtered;},[newsData,searchTerm,selectedSources]);const handleSourceToggle=sourceName=>{setSelectedSources(prev=>prev.includes(sourceName)?prev.filter(name=>name!==sourceName):[...prev,sourceName]);};const formatLastUpdated=dateString=>{try{const date=new Date(dateString);return date.toLocaleString();}catch(error){return'Unknown';}};const handleExportJSON=()=>{if(filteredData){exportToJSON(filteredData,searchTerm);}};const handleExportCSV=()=>{if(filteredData){exportToCSV(filteredData,searchTerm);}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"bg-gray-800/90 backdrop-blur-md shadow-lg border-b border-gray-700\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center py-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-indigo-400 bg-clip-text text-transparent\",children:\"Financial News Aggregator\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-300 mt-1 font-medium\",children:\"\\uD83D\\uDE80 Loading latest financial news...\"})]}),/*#__PURE__*/_jsx(LoadingSpinner,{size:\"sm\"})]})})}),/*#__PURE__*/_jsx(\"main\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4\",children:[...Array(6)].map((_,index)=>/*#__PURE__*/_jsx(SkeletonLoader,{className:\"h-fit\"},index))})})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"bg-gray-800/90 backdrop-blur-md shadow-lg border-b border-gray-700\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center py-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-indigo-400 bg-clip-text text-transparent\",children:\"Financial News Aggregator\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-300 mt-1 font-medium\",children:\"\\uD83D\\uDE80 Real-time financial news from trusted sources\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 mt-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-400\",children:[\"\\uD83D\\uDCC5 \",new Date().toLocaleDateString('en-US',{weekday:'long',year:'numeric',month:'long',day:'numeric'})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-400\",children:[\"\\uD83D\\uDD50 \",new Date().toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[newsData&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleExportCSV,className:\"inline-flex items-center px-4 py-2 border border-gray-600 text-sm font-medium rounded-lg text-gray-300 bg-gray-800 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z\"})}),\"CSV\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleExportJSON,className:\"inline-flex items-center px-4 py-2 border border-gray-600 text-sm font-medium rounded-lg text-gray-300 bg-gray-800 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z\"})}),\"JSON\"]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRefresh,disabled:refreshing,className:\"inline-flex items-center px-6 py-3 border border-transparent text-sm font-semibold rounded-xl shadow-lg text-white bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 transition-all duration-200\",children:refreshing?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LoadingSpinner,{size:\"sm\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2\",children:\"Refreshing...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"})}),\"Refresh\"]})})]})]})})}),/*#__PURE__*/_jsxs(\"main\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[error&&/*#__PURE__*/_jsx(ErrorMessage,{message:error,onRetry:handleRetry,className:\"mb-6\"}),newsData&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-800/90 backdrop-blur-sm rounded-2xl shadow-xl border border-gray-700 px-8 py-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row sm:items-center sm:justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-bold bg-gradient-to-r from-emerald-400 to-blue-400 bg-clip-text text-transparent\",children:\"\\uD83D\\uDCCA News Summary\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-200 font-medium\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-2 py-1 rounded-full bg-emerald-900 text-emerald-200 text-xs font-semibold mr-2\",children:[newsData.total_sources,\" sources\"]}),\"\\u2022 Last updated: \",formatLastUpdated(newsData.last_updated)]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 sm:mt-0\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-bold bg-emerald-900 text-emerald-200 border border-emerald-700 shadow-sm\",children:[\"\\u26A1 Cache: \",newsData.cache_status]})})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-800/90 backdrop-blur-sm rounded-2xl shadow-xl border border-gray-700 px-8 py-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 max-w-md\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"search\",className:\"sr-only\",children:\"Search headlines\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"h-5 w-5 text-gray-400\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"})})}),/*#__PURE__*/_jsx(\"input\",{id:\"search\",type:\"text\",placeholder:\"Search headlines...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"block w-full pl-10 pr-3 py-2 border border-gray-600 rounded-lg bg-gray-700 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:newsData.sources.map(source=>/*#__PURE__*/_jsxs(\"label\",{className:\"inline-flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedSources.includes(source.name),onChange:()=>handleSourceToggle(source.name),className:\"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500 focus:ring-offset-0\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-sm text-gray-300 font-medium\",children:source.name.split(' ').slice(0,2).join(' ')})]},source.name))})]})})})]}),filteredData&&filteredData.sources.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4\",children:filteredData.sources.map(source=>/*#__PURE__*/_jsx(NewsSource,{source:source,className:\"h-fit\"},source.name))}):!error&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mx-auto h-12 w-12 text-gray-400\",children:/*#__PURE__*/_jsx(\"svg\",{fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z\"})})}),/*#__PURE__*/_jsx(\"h3\",{className:\"mt-2 text-sm font-medium text-gray-100\",children:\"No news available\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-gray-400\",children:\"Try refreshing to fetch the latest headlines.\"})]})]})]});};export default Dashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}